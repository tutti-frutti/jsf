<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;subset=cyrillic,cyrillic-ext" rel="stylesheet">
    <link rel="stylesheet" href="css/libs.min.css">
    <link rel="stylesheet" href="css/main.css">

    <title>Ajax</title>

    <style>
    </style>
</head>

<body>

    <header class="header"></header>

    <main class="center">
        <div class="select">
            <label for="select-choice">Выбираем параметры</label>
            <select name="" id="select-choice">
                <option value="select-option">Выбрать</option>
                <option value="first">Вариант-1</option>
                <option value="second">Вариант-2</option>
                <option value="third">Вариант-3</option>
                <option value="fourth">Вариант-4</option>
                <option value="fifth">Вариант-5</option>
            </select>
            <div class="select-choice-results"></div>
        </div>
        <!--select-->

        <template id="template-select">
            <section>
               <div class="template-block">
                    <span>Item name:</span>
                    <span class="Item name">Item name</span>
                </div>
                
                <div class="template-block">
                    <span>Article:</span>
                    <span class="article"></span>
                </div>
                
                <div class="template-block">
                    <span>Color:</span>
                    <span class="color"></span>
                </div>
                
                <div class="template-block">
                    <span>Price:</span>
                    <span class="price"></span>
                </div>
            </section>
        </template>
    </main>

    <footer></footer>

    <script src="js/libs.min.js"></script>
    <script src="js/common.js"></script>
    <script>
        var container = document.getElementsByClassName('select-choice-results');

        //                function getDataSelect() {
        //                    var xhr = new XMLHttpRequest();
        //                    xhr.open('GET', 'js/data/select.json');
        //                    xhr.onload = function(evt) {
        //                        var rawData = evt.target.response;
        //                        var loadedSelects = JSON.parse(rawData);
        //                        console.log(loadedSelects);
        //                    }
        //                    xhr.send();
        //                };
        //
        //                getDataSelect();

        $.ajax({
            type: 'GET',
            url: 'js/data/select.json',
            dataType: 'json',
            success: function(data) {
                var loaded = data;
                renderItems(loaded);
            },
            onerror: function() {
                console.log('cannot get data')
            }
        });

        function renderItems(loaded) {
            var select = $('#select-choice');
            $(select).change(function() {
                var options = select.val();
                console.log(options);
                var filtered = loaded.filter(function(items, i) {
                    var name = loaded[i].name;
                    if (name == options) {
                        return loaded[i].name;
                    }
                    console.log(name);
                    container.innerHTML = '';
                    filtered.forEach(function(item) {
                        var element = getFromTemplate(item);
                        container.appendChild(element);
                    });
                })
            })
        }

        function getFromTemplate(data) {
            var template = document.getElementById('template-select');
            var element = template.content.children[0].clone(true);

            element.querySelector('.item-name').textContent = data.name;
            element.querySelector('.article').textContent = data.sku;
            element.querySelector('.colors').textContent = data.colors;
            element.querySelector('.price').textContent = data.price;
            return element;
        }
    </script>
</body>

</html>